%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\subsection{Graphical models}
%-------------------------------------------------------------------------------

%==================================================================
\frame{\frametitle{Directed graphs = Bayesian networks}

  \paragraph{Definition.} Let $D$ be a {\sl directed acyclic graph} (\emphase{DAG}), the distribution $p$ is said to factorize in $D$ iff
  $$
  p(x_1, \dots x_n) = \prod_{i=1}^n p(x_i \mid x_{pa_D(i)})
  $$
  where $pa_D(i)$ stands for the set of parents of $i$ in $D$.

  \bigskip \pause
  \begin{tabular}{cc}
    \begin{tabular}{c}
    $\input{\figeco/DAG6nodes}$
    \end{tabular}
    &
    \begin{tabular}{p{.7\textwidth}}
      \begin{eqnarray*}
        pa_D(A) = \emptyset, & & pa_D(D) = \{B, C\}, \qquad \dots  \\
        \\
        p(a, \dots f) & = 
        & p(a) \; p(b \mid a) \; p(c \mid a) \\
        & & p(d \mid b, c) \; p(e \mid d) \\
        & & p(f \mid b, d)
        \end{eqnarray*}
    \end{tabular}
  \end{tabular}
  
  \bigskip
  See \refer{SWA17} for an introduction in ecology
}

%==================================================================
\frame{\frametitle{A simple (interesting) example}

  Consider $D =$
  $$
  \input{\figeco/LeftRightChain}
  $$
  $p(x, y, z)$ is faithful to $D$ iff
  $$
  p(x, y, z) = p(x) \; p(y \mid x) \; p(z \mid y) 
  $$ \pause
  But
  \begin{align*}
   p(x) \; p(y \mid x) \; p(z \mid y) 
%    & = p(x) \; \frac{p(x, y)}{p(x)} \; \frac{p(y, z)}{p(y)} \\
%    & = \frac{p(x, y)}{p(y)} \; \frac{p(y, z)}{p(z)} \; p(z) \\
   & = p(x \mid y) \; p(y \mid z) \; p(z) 
  \end{align*}
  so $p$ is also faithful to $D' =$
  $$
  \input{\figeco/RightLeftChain} 
  $$
  \pause and to $D'' =$
  $$
  \input{\figeco/AwayFromCenter}
  $$
  
  \bigskip \pause
  \paragraph{Conclusions.} 
  \begin{itemize}
   \item $p(x)$ is not enough to retrieve the edge orientations
   \item No causal interpretation (causality not addressed here, see \refer{Pea09,Pea09b})
  \end{itemize}
}
  
%==================================================================
\frame{\frametitle{A nice case: Dynamic 'Bayesian' networks (DBN)}

  \paragraph{Temporal data:} $A_t =$ expression of gene $A$ at time $t$
 
  \bigskip
  \begin{tabular}{p{.48\textwidth}p{.48\textwidth}}
  \paragraph{Genuine graphical model.} A DAG: &
  \paragraph{Usual representation.}  \\ 
  $$
  \renewcommand{\nodesize}{2em}
  \input{\figeco/DBN4nodes}
  \renewcommand{\nodesize}{\commonnodesize}
  $$
  &
  $$
  \renewcommand{\nodesize}{2em}
  \input{\figeco/DBN4nodes-collapsed}
  \renewcommand{\nodesize}{\commonnodesize}
  $$
  (not a DAG)
  \end{tabular}
  
  \paragraph{Simpler reconstruction problem:} 
  Find the parents of each gene $A$, $B$, ... \emphase{independently}
}
