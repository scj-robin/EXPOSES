document     landscape ewcounterchapter ewcountersection ewcountersubsection setcounterchapter0 headrulewidth 0pt pagestylefancy cfoot rfootrotate90 1cm tiny S. Robin: Motif statistics rotate rheadrotate90 -.5cm tiny thepage rotate 

   Motifs statistics 0.5cm in biological sequences and networks 

1cm S. Robin 

UMR INA-PG / ENGREF / INRA, Paris Mathématique et Informatique Appliquées 

Statistics for Biological Sequences group 

 

0.5cm Outline.  Some extensions and open questions for standard motifs More complex motifs / Effective computations Towards motifs in random graphs  

   (Brief) motivation   

Motif statistics are part of the standard tools of genomic sequences analysis. The search for motifs (short sequences of nucleotides a, tt c, g, t) having specific functions or unexpected behavior is a way to understand the genetic information. 

Some typical questions: (cf. Book)  -0.5cm [Blind search:] In a new genome Sbf, consider all the words of length k (4^k possible words) and detect the unexpectedly frequent (or rare) ones. Ex: palindromes of length 6 or 8 are avoided in E. coli's genome. -0.5cm [Distribution along the genome:] Given a motif with known function, detect the region of the genome where its occurrences are 'too' abundant (or rare). Ex: Distribution of the CHI sites in bacterial genomes. -0.5cm [Structured motif:] Given a general specified structure and some regions where the motif is expected to occur, detect the motif that actually fulfills the biological function. Ex: Detection of promoter motifs.  

  Need for a model  This questions can only be answered if we know what to expect. The role of the statistical model is to describe the expected behavior. 

Most popular models. -0.5cm  [Markov chain (MC):] The observed sequence Sbf = (X_1, X_1,... X_n) is supposed to be generated by a stationary MC of order m (MCm) with transition Pibf and stationary distribution mubf. Exact results about the occurrence probability, the distribution of the number of occurrences (count Nw), the distance between occurrences are available. Many approximations of the distribution of the counts (Gaussian, compound Poisson, binomial,...) are used in practice. [Compound Poisson process:] The sequence is seen as a continuous line. The motif occurs in clumps. The clumps occur according to a Poisson process with intensity lambda. The clump sizes are iid with geometric distribution Gcal(1-a), where a is the overlapping probability of the motifs.  



   Extensions and open questions for standard motifs   

  Large deviation for the count  

In a sequence Sbf of length ell, the word wbf occurs w times. We want to evaluate  PrNw geq w  especially in the case where the observed count is much larger than expected:  w gg Esp Nw.  The large deviation approche is quite natural. 

The PhD of G. Nuel (Evry, 2001) and P. Pudlo (Lyon, 2004) both propose approximations for PrNw geq w and the joint probability Pr (N_wbf_i geq n_wbf_i)_i=1, 2,...) in the homogenous MCm framework. 

The practical implementation requires the calculation of the largest eigenvalue of a matrix of size m^k. 

  Heterogenous Markov models  

  Comparing genomes  

Comparative genomics. The number of occurrences of the word wbf is N_1 in sequence Sbf_1 (length ell_1) and N_2 in sequence Sbf_2 (length ell_2). Is wbf 'more exceptional' in Sbf_1 than in Sbf_2? 

Example. If N_1 sim Pcal(lambda_1) and N_2 sim Pcal(lambda_2) then, denoting N_+ = N_1+N_2,  N_1;|; N_+ sim Bcalleft(N_+, lambda_1lambda_1+lambda_2 right).  The parameter lambda_i accounts for the length ell_i and the composition of Sbf_i. 

Exercise. Same problem with compound Poisson distribution (for overlapping words):  -0.5cm Compare the number of clumps. -0.5cm Compare the clumps sizes.  

  Mosaic project. Comparison of bacterial genome based on multiple genome alignment (Chiapello al., 05). Example: The comparison of 3 strains of E. coli (textblueCFT, textredSakai and textgreenK12) 

-1.6cm tabularll Backbone and loops. & Motifs statistics.   Backbone = common parts & Comparison backbone / loops Loops = specific parts & for a specific strain (K12). tabularp10cm  epsfigfile =../Figures/Backbone-Loops.ps, clip=, bbllx=190, bblly=120, bburx=400, bbury=340  (Source: EL Karoui, 06) tabular & tabularp12cm  CHI sites are much more frequent in the backbone than in the loops; Palindromes are more frequent in the loops than in the backbone; Palindromes are yet avoided in the older loops.  tabular tabular 

  What about statistics?  

Approximation + Estimation. Most distributions used in practice (Ncal, Pcal, CcalPcal) only approximate the exact distribution under an MCm model. 

The parameter theta of the approximated distribution depends on the true transition matrix Pibf. 

Pibf is actually estimated by widehatPibf and a plug-in version widehattheta of theta is used for calculation. 

Denoting Qcal the true distribution and Pcal(theta) the approximation, we have  d(Qcal, Pcal(widehattheta)) leq undersetmboxApproximationunderbraced(Qcal, Pcal(theta)) + undersetmboxEstimationunderbraced(Pcal(theta), Pcal(widehattheta)).  

Only Prum & al. and Schbath (95) take into account the fact that widehatPibf and w are observed on the same sequence. 

  What can we do? 

 Pangloss: The genome of B. subtilis is the one we observe. There is no theoretical Pibf, only widehatPibf makes sense. 

 Panic: Simulations in the MCm framework show that the estimation error may be much larger than the approximation error, especially for large m. Longrightarrow never consider MCm with m larger than 3 or 4. 

 But. Biological sequences are not Markov chains. The variability between different copies of the genome of a same species has nothing to do with the variability between different paths of a Markov chain. 

 Some bacterial genomes E. coli (?) have been sequenced several times: this variability can be studied now. 

   More complex motifs   

  Structured motifs  

 Promoter motifs 

Structured motifs where the polymerase binds to DNA  pspicture(20, 2.5)(0, -2.5) [linewidth=0.05, linestyle=dashed, linecolor=black]<-|(0, 1.2)(14.2, 1.2) [B]0(6.85, 1.4)simeq 100 bps 

[linewidth=0.1, linecolor=black](0, 0)(3.3, 0) [B]0(4, -0.1)fboxrule[-0.2cm]0cm0.8cm;wbf_1; [linewidth=0.1, linecolor=black](4.7, 0)(7.3, 0) [B]0(8, -0.1)fboxrule[-0.2cm]0cm0.8cm;wbf_2; [linewidth=0.1, linecolor=black](8.7, 0)(14.2, 0) [B]0(17, -0.1)fboxrule[-0.2cm]0cm0.8cm gene 

[linewidth=0.05, linestyle=dashed, linecolor=black]<->(4.7, -1)(7.2, -1) [B]0(5.95, -2)16 bps leq d leq 18 bps pspicture  Which structured motifs occur almost (too ?) systematically in upstream regions of the genes of a given species? 

  A first approximation  Difficulty: Complexity of the overlapping structure of structured motif  pspicture(11, 1.75)(0, 0.75) [B]0(1, 1)mbf = frameboxwbf_1 [linewidth=0.1, linecolor=black]<->(3.2, 1.1)(8.7, 1.1) [B]0(10, 1)frameboxwbf_2 [B](6, 1.3)d pspicture  impossible to calculate the exact distribution of the waiting time with the classical method (generating function). 

Approximation (R. & al, 02) -0.5cm  Probability for mbf to occur at a given position (using the distribution of the distances): mu(mbf) Approximation of order 0 (geometric) does not work (simulations):  gamma(mbf) = Pr left N(wbf) geq 1 right approx 1 - [1 - mu(mbf)]^ell - |mbf| + 1.  Approximation of order 1 left(mu_1(mbf) = Prmbf mbox at x | mbf mbox not at x-1right):  gamma(mbf) approx 1 - [1 - mu(mbf)] [1 - mu_1(mbf)]^ell-|mbf|   



  Exact distribution of the waiting time  

Decomposition of the waiting process. wbf_2 = square, wbf_2 = bigcirc: 

 epsfigfile=../Figures/WaitingStructuredMotif.ps, clip=, bbllx=112, bblly=610, bburx=470, bbury=700, width=18cm  -0.5cm To get an occurrence of mbf we have to  -0.5cm wait for an occurrence of wbf_1, -0.5cm followed by an occurrence of wbf_2 -0.5cm and check if wbf_2 occurs at an admissible distance of wbf_1.  The number of failure before success has a geometric distribution. (Stefanov, Schbath, R., 05) 

  Denote  -0.5cm [T_ij, i,jin1,2:] the waiting time to reach pattern wbf_j from pattern wbf_i; -0.5cm [T_j^(s):] the waiting time to reach pattern wbf_j from state s; -0.5cm [r_ij, i,jin1,2:] the probability that the first pattern from the family mathcalW to be reached is w_j, given we start from pattern wbf_i; -0.5cm [S_12] (resp. F_12) = X_12 conditional to a success (resp. failure).  The generating functions of the waiting time until mbf starting from letter s and from word wbf_2 are  G_mbf^(s)(t) &=&  r_12, q_S, G_T_1^(s)(t),G_S_12(t) left[1- (1-r_12) G_X_11(t) right] left[1-(1-q_S) r_12, G_T_21(t), G_F_12(t) 1- (1-r_12) G_X_11(t) right],  G_mbf^(wbf_2)(t) &=&  r_12, q_S, G_T_21(t), G_S_12(t) left[1- (1-r_12) G_X_11(t) right] left[1-(1-q_S) r_12, G_T_21(t), G_F_12(t) 1- (1-r_12) G_X_11(t) right].  G_mbf gives the probability gamma_ell(mbf) that a sequence with length ell. 

  Motif detection. Among n sequences with same length, the number N of sequences containing mbf has a binomial distribution: N sim Bcal(n, gamma_ell(mbf)). 

-2cm tabularll tabularp4cm Promoters in B. subtilis:  regions of 100 bps upstream of n=131 genes (biologically validated)  p-value < 10^-16  (putative alignment) tabular & tabularl small tabularlclccc multicolumn1cwbf_1 & (d_1:d_2) & multicolumn1cwbf_2 & N & gamma_ell(mbf) & p-value hline ttgactt   & (16:18) &  ataataa & 3 & 1.16,10^-5 & 5.77,10^-10 tgactt  & (16:18) &  ataataa & 3 & 3.02,10^-5 & 1.00,10^-8 ttgactt   & (16:18) &  atactaa & 2 & 4.01,10^-6 & 1.37,10^-7 tgactt  & (16:18) &  atactaa & 2 & 1.04,10^-5 & 9.18,10^-7 ttgaca    & (16:18) & tataatg   & 2 & 1.60,10^-5 & 2.18,10^-6 ttgaca    & (16:18) & tatatta   & 2 & 2.36,10^-5 & 4.75,10^-6 ttgact    & (16:18) & tatact    & 2 & 2.38,10^-5 & 4.81,10^-6 ttgaca    & (16:18) & tataata   & 2 & 2.48,10^-5 & 5.23,10^-6 ttgaca    & (16:18) & atataat     & 2 & 2.74,10^-5 & 6.39,10^-6 tgacttt & (16:18) &   taataa & 2 & 3.63,10^-5 & 1.12,10^-5 gacttt & (16:18) &   taataa & 2 & 1.06,10^-4 & 9.52,10^-5 gttgaca     & (16:18) & tataata   & 1 & 3.89,10^-6 & 5.09,10^-4 gttgaca     & (16:18) & atataat     & 1 & 4.30,10^-6 & 5.63,10^-4 ttgacac   & (16:18) &  ataataa & 1 & 4.88,10^-6 & 6.39,10^-4 gttgac      & (16:18) & ctataat     & 1 & 4.88,10^-6 & 6.39,10^-4 tabular  tabular tabular 

   Effective computation of the distributions   

  Automata  

Example. Automat counting the overlapping occurrences of wbf = aba: 

 epsfigfile =../Figures/Automat-abab.ps, clip=, bbllx=45, bblly=152, bburx=535, bbury=344 epsfigfile =../Figures/Automat-aba.ps, clip=, bbllx=80, bblly=435, bburx=540, bbury=650 -1.5cm (Source: Nicodème, 02) 

  Combinatorial tools 

Such automaton can be build automatically for (even complex) regular motifs. 

Exact distribution. The associated generating function is derived at the same time (cf. RegExpCount package, Nicodème, 01). 

 1cm Finite Markov chains imbedding (FCMI) 

Denote Pbf the transition matrix the Markov chain associated the preceding graph. If the sequence under study is a Markov chain with transition matrix Pibf, we have  Pbf = left(cccc pi(b, b) & pi(a, b) & 0 & 0 0 & pi(a, a) & pi(a, b) & 0 0 & 0 & pi(b, b) & pi(b, a) 0 & 0 & pi(a, a) & pi(a, b) right)   -0.5cm The count N_wbf is distributed as the number of visit in the last state. -0.5cm If the last state is replaced by an absorbing state, the waiting time T_wbf is geometrically distributed. (cf. Nuel, 06)  

   Towards motifs in random graphs   

  Biological networks  

-2cm tabularll tabularp9cm Regulatory networks. Vertices = genes, i rightarrow j means that gene i induces or represses gene j. (directed graph)  Protein interaction networks. Vertices = proteins, i leftrightarrow j means that proteins i and j can bind to each other. (2 hybrid technology, undirected graph).  Right: Yeast protein interaction network (Barabasi, 04) tabular & tabularl epsfigfile = /RECHERCHE/RESEAUX/EXPOSES/FIGURES/Barabasi6.ps, clip=, bbllx=39, bblly=466, bburx=351, bbury=754, width=15cm, height=14cm tabular tabular 

  Motifs in graphs  

Some regulatory motifs:  (Source: Shen-Orr, 02)  tabularccc Feed-forward loop: & Single input module: & Dense overlapping regulons: epsfigfile = /RECHERCHE/RESEAUX/EXPOSES/FIGURES/RegulationMotifs.ps, clip=, bbllx=143, bblly=437, bburx=193, bbury=498, scale=1.5 & epsfigfile = /RECHERCHE/RESEAUX/EXPOSES/FIGURES/RegulationMotifs.ps, clip=, bbllx=142, bblly=269, bburx=210, bbury=335, scale=1.5 & epsfigfile = /RECHERCHE/RESEAUX/EXPOSES/FIGURES/RegulationMotifs.ps, clip=, bbllx=112, bblly=100, bburx=260, bbury=162, scale=1.5 tabular  The motif mbf is observed n_wbf times in the graph. Is n_wbf significantly large?  epsfigfile = /RECHERCHE/RESEAUX/EXPOSES/FIGURES/RegulationMotifs-Signif.ps, clip=, bbllx=78, bblly=613, bburx=514, bbury=725, scale=1.5  

  Models for random graphs  

  Undirected graphs. We only consider here undirected graphs. (Almost) all the results to follow can be generalised to directed graphs. 

  What is a model? 

Consider n vertices (i=1..n) connected by random edges:  X_ij = Ibbi leftrightarrow j.  The model gives the join distribution of X_ij_1 leq i < j leq n. 

Degree of a vertex: D_i is the number of edges connecting j:  D_i = sum_j eq i X_ij.  The distribution of the D_i's is not sufficient to characterise the random graph. 

  What should it fit? 

As for DNA sequences, we need to define models to generate graphs having the same characteristics (exactly?, in average?) as the observed one. 

Typical characteristics.  -0.5cm [Density:] The number of edges or the proportion of node pairs that are connected. -0.5cm [Degree of each node:] i.e. (D_1, D_2,.... D_n). -0.5cm [Degree distribution:] D_i `i.i.d.' sim widehatF, where widehatF is the empirical distribution or some parametric version of it. -0.5cm [Modular structure:] Nodes may be grouped into classes with same connection profile.  

  Some simple models 

Erdös-Renyi (ER): The edges are independent and all node pairs have the same probability pi to be connected:  X_ij mbox i.i.d. sim Bcal(pi).  

Node degree fit: Sample uniformly in the set of graphs of size n such as  D_1 = d_1, D_2 = d_2,... D_n = d_n.  rightarrow Permutation model. Implicitly: Pri leftrightarrow j propto d_i d_j. Non stationary model. 

 Parametric degree distribution: Typically, F = Poisson, scale free (P(d) propto d^-alpha), Poisson mixture.  -0.5cm Node i samples its degree D_i sim F. -0.5cm Pri leftrightarrow j propto d_i d_j. Stationary model.  

  Scale free network model. (Barabasi & Albert, 99) 

The network is build iteratively: the i-th vertex joining the network connects one of the (i-1) preceeding ones with probability proportional to their current degree ('busy gets busier'):  forall j < i, Pr0cm^i i leftrightarrow j propto D_j^i.  The limit marginal distribution of the degree is then scale free (Zipf): p(d) propto d^-3. 

Erdös-Renyi Mixture for Graphs (ERMG). (Daudin, Picard, R., 06) 

Nodes are spread into Q groups with proportions alpha_1, ... alpha_Q. Denoting Z_i the class of node i:  Z_i mbox i.i.d. sim Mcal(1; alpha_1,... alpha_Q).  The connexion probability depends on the classes of the node:  X_ij mbox independent,  (X_ij;|;Z_i = s, Z_j = ell) sim Bcal(pi_qell).  

  Existing results on random graphs 

Erdös-Renyi model. A huge amount of results about the behaviour of ER graphs regarding  -0.5cm the degree distribution (Poisson); -0.5cm the existence and the size of a giant component; -0.5cm the number of occurrences of motifs (Poisson and compound Poisson approximations); -0.5cm etc.  -0.5cm But ER fits very poorly most observed networks. 

 Generating functions. Generating functions can be used to derive exact results such as the distribution of the cluster size. 

As for sequences, such strategies are based on recursive properties and require that the graph is 'tree like'. 

But biological networks are not tree-like. 

  Some results for more general models  

(with E. Birmelé, J.J. Daudin, C. Matias, F. Picard, E. Roquain, S. Schbath) 

Motif definition. A network motif of size k (i.e. involving k vertices) is characterised by an adjacency matrix mbf:  tabularll tabularl m_uv = 1 if an edge is required between nodes u and v;  m_uv = 0 otherwise. tabular & ccccc mboxMotif & k & mbf & mboxaut(mbf) & rho(mbf) hline vee & 3 & left( small ccc 0&1&1&0&0&&0 right) & 2 & 3 triangle & 3 & left(small ccc 0&1&1&0&1&&0 right) & 6 & 1 square & 4 & left(small cccc 0&1&0&1&0&1&0&&0&1&&&0  right) & 8 & 3  tabular  mboxaut(mbf) = number of automorphism of mbf. Rcal(mbf) = set of non-redundant permutations of mbf; rho(mbf) = |Rcal(mbf)| = k! / mboxaut(mbf). 

  Occurrence of a motif. For any position alpha = (i_1,.. i_k) (1 leq i_1 < i_2 <... < i_k leq n), we define Y_alpha(mbf):  Y_alpha(mbf) = Ibbmbf mbox occurs at alpha = (i_1,..i_k) = prod_1 leq u < v leq k X_i_u i_v^m_uv.  

Number of occurrences. The count we are studying is  N_wbf = sum_alpha sum_mbf' in Rcal(mbf) Y_alpha(mbf').  The squared count is displaystyleN_wbf^2 = sum_alpha, beta sum_mbf', mbf'' in Rcal(mbf) Y_alpha(mbf') Y_alpha(mbf''). 

Stationary hypothesis. We assume that the expectation of Y_alpha(mbf) is the same all over the graph:  Esp Y_alpha(mbf) = mu(mbf).  

Occurrence probability. The probability for mbf (or one of its permutated version) to occur at any position alpha is  sum_mbf' in Rcal(mbf) Esp Y_alpha(mbf') = sum_mbf' in Rcal(mbf) mu(mbf') = rho(mbf) mu(mbf).  



  Mean and variance of the count 

-2cm tabularcc tabularp10cm  Esp N(mbf) = binomnk rho(mbf) mu(mbf).   Esp N^2(mbf) = displaystylesum_s=0^k left[ binomnk-s, s, k-s right. displaystyle left. sum_mbf', mbf'' in Rcal(mbf) mu(mbf'undersetsOmega mbf'') right]  On the right: Star with 4 spikes (k=5): tabularcc tabularc mbf = tabular & tabularc -2cm    epsfigfile = /RECHERCHE/RESEAUX/EXPOSES/FIGURES/Motif-Star4.eps, clip=, width=2cm, height=2cm tabular tabular All possible overlaps with s=3 nodes: mbf'underset3Omegambf''. tabular & tabularc epsfigfile= /RECHERCHE/RESEAUX/Motifs/FIGURES/MotifStar4-Recouv3.eps, clip, width=12cm, height=15cm tabular tabular 





  Approximate distribution 

Based on simulations and analogy with motif statistics in sequences, we propose to use the compound Poisson distribution (Polya-Aepply) to approximate the distribution of N_mbf. 

The parameters of this distribution are derived from Esp N_mbf and Var N_mbf. 

-2cm tabularcc tabularp12cm Example: Distribution of the number of loops with 4 nodes (square) in a graph of size n=200, under ERMG model with Q=2 groups and parameters  alphabf = [cc 0.9 & 0.1 ], Pibf = left[ cc 0.004 & 0.037 0.037 & 0.004 right].  tabular & -1.3cm tabularc epsfigfile=/RECHERCHE/RESEAUX/Motifs/FIGJJD-150506/fig11_200.eps, bbllx=332, bblly=211, bburx=515, bbury=304, width=12cm, height=7cm, clip= textred--- Gaussian, textgreen--- Compound Poisson, epsfigfile= /RECHERCHE/RESEAUX/Motifs/FIGURES/DistStar4.eps, clip=, width=14cm, height=12cm tabular tabular The motif mbf = square may occur at coefbin2004 = 65;10^6 positions. We get  Esp N_mbf = 7.3, Var N_mbf = 21.7  Suppose we observe 20 occurrences: PrN_mbf geq 20) = 1.7 . 

  Conclusions 

Sequences.  -0.5cm Need for efficient computation techniques allowing to study complex and/or fuzzy motifs. rightarrow (statistical, ) algorithmic, combinatoric, numerical issues -0.5cm Need for models accounting not only for the primary information (nucleotide composition), but also for the secondary and tertiary (spatial configuration of the molecule) structures.  

Networks.  -0.5cm Need for models left tabularp17cm Fitting observed networks reasonably well, With parameters reasonably easy to estimate, Involving reasonably complicated combinatorics for the motifs. tabular right. -0.5cm Need for probability and statistics to provide exact or approximate distributions. -0.5cm Need for computer science and algorithmics to calculate all this.  

    document     